"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[2652],{52652:(l,i,e)=>{e.r(i),e.d(i,{default:()=>Z});var o=e(72791),d=(e(76033),e(10252),e(39159)),n=e(96067),s=e(55886),a=e(59434),r=e(66608),t=e(763),c=e.n(t),u=e(87311),v=e(84271),p=e(14565),m=e(38185),h=e(49861),x=e(69023),g=e(80184);const y=l=>{let{setManageGroups:i,manageGroups:e,addUpdate:t,selectedGroup:y}=l;const b=(0,a.v9)(r.w0),[j,f]=(0,o.useState)(""),[N,k]=(0,o.useState)(""),[w,G]=(0,o.useState)(!1),[_,C]=(0,o.useState)(null===y||void 0===y?void 0:y.group_name),[S,Z]=(0,o.useState)(b);(0,o.useEffect)((()=>{var l;let i=c().cloneDeep(S);(null===y||void 0===y||null===(l=y.data)||void 0===l?void 0:l.length)>0&&(null===y||void 0===y||y.data.map((l=>{var e;const o=(null===i||void 0===i?void 0:i.length)>0?i.findIndex((i=>(null===i||void 0===i?void 0:i.id)==(null===l||void 0===l?void 0:l.id))):-1;var d;o>-1&&(null===l||void 0===l||null===(e=l.groupPolicy)||void 0===e?void 0:e.length)>0&&(null===l||void 0===l||null===(d=l.groupPolicy)||void 0===d||d.map((l=>{var e,d;const n=null===i||void 0===i||null===(e=i[o])||void 0===e?void 0:e.grouppolicy.findIndex((i=>(null===i||void 0===i?void 0:i.id)==(null===l||void 0===l?void 0:l.id)));var s;n>-1&&(null===l||void 0===l||null===(d=l.policyTab)||void 0===d?void 0:d.length)>0&&(null===l||void 0===l||null===(s=l.policyTab)||void 0===s||s.map((l=>{var e;const d=i[o].grouppolicy[n].policytab.findIndex((i=>(null===i||void 0===i?void 0:i.id)==(null===l||void 0===l?void 0:l.id)));var s;d>-1&&(null===l||void 0===l||null===(e=l.submodule)||void 0===e?void 0:e.length)>0&&(null===l||void 0===l||null===(s=l.submodule)||void 0===s||s.map((l=>{var e;const s=null===(e=i[o].grouppolicy[n].policytab[d].permission)||void 0===e?void 0:e.findIndex((i=>(null===i||void 0===i?void 0:i.id)==(null===l||void 0===l?void 0:l.id))),a=s>-1;i[o].grouppolicy[n].policytab[d].permission[s].checked=a})))})))})))})),Z([...i]))}),[null===y||void 0===y?void 0:y.data]);const P=(0,o.useCallback)(((l,i)=>{var e,o;Object.freeze(S);let d=c().cloneDeep(S);null===S||void 0===S||null===(e=S[i])||void 0===e||null===(o=e.grouppolicy)||void 0===o||o.map(((e,o)=>{var n;null===e||void 0===e||null===(n=e.policytab)||void 0===n||n.map(((e,n)=>{var s;null===e||void 0===e||null===(s=e.permission)||void 0===s||s.map(((e,s)=>{d[i].grouppolicy[o].policytab[n].permission[s].checked=!l}))}))})),Z([...d])}),[S]),z=(0,o.useCallback)((l=>{var i;const e=[];return(null===l||void 0===l||null===(i=l.grouppolicy)||void 0===i?void 0:i.length)>0&&l.grouppolicy.map((l=>{var i;return(null===(i=l.policytab)||void 0===i?void 0:i.length)>0&&l.policytab.map((l=>{var i;return(null===l||void 0===l||null===(i=l.permission)||void 0===i?void 0:i.length)>0&&l.permission.map((l=>{var i;return e.push(null!==(i=null===l||void 0===l?void 0:l.checked)&&void 0!==i&&i)}))}))})),null===e||void 0===e?void 0:e.every((l=>l))}),[]),B=(0,o.useCallback)((l=>{var i;const e=[];return(null===l||void 0===l||null===(i=l.permission)||void 0===i?void 0:i.length)>0&&l.permission.map((l=>{var i;return e.push(null!==(i=null===l||void 0===l?void 0:l.checked)&&void 0!==i&&i)})),null===e||void 0===e?void 0:e.every((l=>l))}),[]);return(0,g.jsxs)("div",{className:"card ",style:{fontFamily:"Manrope",fontSize:"14px",fontWeight:"600"},children:[(0,g.jsx)(s.Z,{visible:w,full:!0}),(0,g.jsxs)("div",{className:"p-5 d-flex justify-content-between align-items-center flex-wrap",children:[(0,g.jsxs)("div",{className:"text-cmGrey900",style:{fontSize:" 17px",fontFamily:"Manrope"},children:[t," Group"]}),(0,g.jsxs)("div",{className:"d-flex align-items-center gap-10",children:[(0,g.jsx)(p.ZP,{buttonType:p.JB.error,buttonLabel:"Cancel",onClick:()=>i(!e)}),(0,g.jsx)(p.ZP,{buttonType:p.JB.primary,buttonLabel:"Save",onClick:()=>{var l;let o=[];const s=S.map(((l,i)=>({role_id:l.id,group_policy:l.grouppolicy.map(((l,i)=>({policy_id:null===l||void 0===l?void 0:l.id,policy_tabs:l.policytab.map((l=>{var i,e;const d=null===l||void 0===l||null===(i=l.permission)||void 0===i||null===(e=i.filter((l=>null===l||void 0===l?void 0:l.checked)))||void 0===e?void 0:e.map((l=>null===l||void 0===l?void 0:l.id));return o=[...o,...d],{policy_tab_id:null===l||void 0===l?void 0:l.id,permission_id:d}}))})))})));let a={group_name:_,group_data:s};return _?(null===(l=o)||void 0===l?void 0:l.length)<=0?n.Z.error("Select atleast 1 permission"):(G(!0),void(null!==y&&void 0!==y&&y.group_id?(a.group_id=null===y||void 0===y?void 0:y.group_id,(0,d.qSj)(a).then((()=>{i(!e),n.Z.success("Group updated")})).catch((l=>{n.Z.error((0,u.oN)(l))})).finally((()=>{G(!1)}))):(0,d.PwJ)(a).then((()=>{i(!e),n.Z.success("Group created")})).catch((l=>{n.Z.error((0,u.oN)(l))})).finally((()=>{G(!1)})))):n.Z.error("Enter Group Name")}})]})]}),(0,g.jsx)("div",{className:"border border-cmGrey300"}),(0,g.jsxs)("div",{className:"p-sm-10 p-5",children:[(0,g.jsxs)("div",{className:"mb-10 d-flex align-items-center gap-5",children:[(0,g.jsx)("label",{className:"form-label text-cmGrey900 required",style:{fontWeight:"700"},children:"Group Name"}),(0,g.jsx)("div",{children:(0,g.jsx)(v.ZP,{placeholder:"",value:_,onChange:l=>C(l.target.value),rejex:/^[\w\-\s]+$/})})]}),(0,g.jsx)("div",{className:"text-cmGrey900 mb-10",style:{fontSize:"18px",fontFamily:"Manrope",fontWeight:"600"},children:"Policies"}),(0,g.jsx)("div",{className:"border border-cmGrey300"}),(null===S||void 0===S?void 0:S.length)>0&&(null===S||void 0===S?void 0:S.map(((l,i)=>{var e;const o=z(l);return(0,g.jsxs)("div",{className:"py-10",children:[(0,g.jsxs)("div",{className:"d-flex gap-3 align-items-center mb-5",children:[(0,g.jsxs)("div",{className:"text-cmBlack",style:{fontWeight:600,fontSize:"16px",fontFamily:"Manrope"},children:[null===l||void 0===l?void 0:l.guard_name," Policies"]}),(0,g.jsx)("div",{className:"form-check form-check-custom form-check-solid",children:(0,g.jsx)(m.Z,{checked:o,onChange:()=>{P(o,i)}})}),(0,g.jsx)(h.Z,{onClick:()=>{return i=null===l||void 0===l?void 0:l.id,void f(i==j?"":i);var i},arrowDirection:j==(null===l||void 0===l?void 0:l.id)?h.e.up:h.e.down})]}),(null===l||void 0===l?void 0:l.id)==j&&(null===l||void 0===l||null===(e=l.grouppolicy)||void 0===e?void 0:e.map(((l,e)=>{var o;return(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"text-cmBlack w-sm-25 mb-2",style:{fontWeight:600,fontSize:"16px",fontFamily:"Manrope"},children:null===l||void 0===l?void 0:l.policies}),(0,g.jsx)(h.Z,{arrowDirection:N==(null===l||void 0===l?void 0:l.id)?h.e.up:h.e.down,onClick:()=>{return i=null===l||void 0===l?void 0:l.id,void k(i==N?"":i);var i}})]}),(null===l||void 0===l?void 0:l.id)==N&&(null===l||void 0===l||null===(o=l.policytab)||void 0===o?void 0:o.map(((l,o)=>{var d;const n=B(l);return(0,g.jsxs)("div",{className:"",children:[(0,g.jsxs)("div",{className:"my-5",children:[(0,g.jsxs)("div",{className:"form-check form-check-custom form-check-solid",children:[(0,g.jsx)(m.Z,{onChange:()=>{!function(){var l,i,e,o,d,n;let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,t=arguments.length>3?arguments[3]:void 0;Object.freeze(S);let u=c().cloneDeep(S);null===S||void 0===S||null===(l=S[a])||void 0===l||null===(i=l.grouppolicy)||void 0===i||null===(e=i[r])||void 0===e||null===(o=e.policytab)||void 0===o||null===(d=o[t])||void 0===d||null===(n=d.permission)||void 0===n||n.map(((l,i)=>{u[a].grouppolicy[r].policytab[t].permission[i].checked=!s})),Z(u)}(n,i,e,o)},checked:n}),(0,g.jsx)("label",{className:"form-check-label text-cmGrey900",children:l.tabs})]}),(0,g.jsx)("div",{className:"ps-sm-20 ps-10 d-sm-flex align-items-center gap-20 mt-5",children:null===l||void 0===l||null===(d=l.permission)||void 0===d?void 0:d.map(((l,d)=>(0,g.jsxs)("div",{className:"form-check form-check-custom form-check-solid",children:[(0,g.jsx)(m.Z,{checked:null===l||void 0===l?void 0:l.checked,onChange:l=>{((l,i,e,o)=>{var d,n,s,a,r,t,u,v,p,m,h,g,y,b,j,f,N,k,w,G,_,C;Object.freeze(S);let P=c().cloneDeep(S),z=null!==(d=null===P||void 0===P||null===(n=P[l])||void 0===n||null===(s=n.grouppolicy)||void 0===s||null===(a=s[i])||void 0===a||null===(r=a.policytab)||void 0===r||null===(t=r[e])||void 0===t||null===(u=t.permission)||void 0===u||null===(v=u[o])||void 0===v?void 0:v.checked)&&void 0!==d&&d,B=null,M=null,F=null,L=null;null===P||void 0===P||null===(p=P[l])||void 0===p||null===(m=p.grouppolicy)||void 0===m||null===(h=m[i])||void 0===h||null===(g=h.policytab)||void 0===g||null===(y=g[e])||void 0===y||null===(b=y.permission)||void 0===b||b.map(((l,i)=>{var e,o,d,n;(null===l||void 0===l||null===(e=l.guard_name)||void 0===e?void 0:e.toLowerCase())==x.BX.view&&(B=i),(null===l||void 0===l||null===(o=l.guard_name)||void 0===o?void 0:o.toLowerCase())==x.BX.edit&&(F=i),(null===l||void 0===l||null===(d=l.guard_name)||void 0===d?void 0:d.toLowerCase())==x.BX.delete&&(M=i),(null===l||void 0===l||null===(n=l.guard_name)||void 0===n?void 0:n.toLowerCase())==x.BX.add&&(L=i)}));const X=null===P||void 0===P||null===(j=P[l])||void 0===j||null===(f=j.grouppolicy)||void 0===f||null===(N=f[i])||void 0===N||null===(k=N.policytab)||void 0===k||null===(w=k[e])||void 0===w||null===(G=w.permission)||void 0===G||null===(_=G[o])||void 0===_||null===(C=_.guard_name)||void 0===C?void 0:C.toLowerCase();L>=0&&X==x.BX.add&&(P[l].grouppolicy[i].policytab[e].permission[L].checked=!z,B>=0&&!z&&(P[l].grouppolicy[i].policytab[e].permission[B].checked=!0)),F>=0&&X==x.BX.edit&&(P[l].grouppolicy[i].policytab[e].permission[F].checked=!z,B>=0&&!z&&(P[l].grouppolicy[i].policytab[e].permission[B].checked=!0)),M>=0&&X==x.BX.delete&&(P[l].grouppolicy[i].policytab[e].permission[M].checked=!z,B>=0&&!z&&(P[l].grouppolicy[i].policytab[e].permission[B].checked=!0)),B>=0&&X==x.BX.view&&(z&&(L>=0&&(P[l].grouppolicy[i].policytab[e].permission[L].checked=!1),F>=0&&(P[l].grouppolicy[i].policytab[e].permission[F].checked=!1),M>=0&&(P[l].grouppolicy[i].policytab[e].permission[M].checked=!1)),P[l].grouppolicy[i].policytab[e].permission[B].checked=!z),[x.BX.add,x.BX.view,x.BX.delete,x.BX.edit].includes(X)||(P[l].grouppolicy[i].policytab[e].permission[o].checked=!z),Z(P)})(i,e,o,d)}}),(0,g.jsx)("label",{className:"form-check-label text-cmGrey700",children:null===l||void 0===l?void 0:l.guard_name})]},d)))})]}),(0,g.jsx)("div",{className:"border border-cmGrey300"})]},o)})))]},e)})))]},i)})))]})]})};e(1869);var b=e(10534),j=e(16871),f=e(95746),N=e(11944),k=e(96023);const w=l=>{let{manageGroups:i,setManageGroups:e,permissionGroupList:o,deletePermission:d,updatePermission:n}=l;const s=(0,j.s0)();return(0,g.jsx)("div",{children:(0,g.jsx)("div",{className:" bg-cmwhite",style:{position:"relative",fontSize:"14px"},children:(0,g.jsx)("div",{className:"py-0 px-0 mx-0",children:(0,g.jsx)("div",{id:"get1",className:"table-responsive overflow-auto",children:(0,g.jsxs)("table",{className:"table",children:[(0,g.jsx)("thead",{className:u.fd,children:(0,g.jsxs)("tr",{className:" bg-cmGrey300 text-cmGrey900",style:{fontSize:"14px",fontWeight:"700",fontFamily:"Manrope"},children:[(0,g.jsx)("th",{className:"w-200px p-5 text-nowrap ",children:"Group Name"}),(0,g.jsx)("th",{className:"w-auto p-5 ",children:"Policies"}),(0,g.jsx)("th",{className:"w-auto p-5 ",children:"Members"}),(0,g.jsx)("th",{className:"w-auto p-5 "})]})}),(0,g.jsx)("tbody",{className:u.fd,children:(null===o||void 0===o?void 0:o.length)>0?(0,g.jsx)(g.Fragment,{children:null===o||void 0===o?void 0:o.map(((l,i)=>{var e,o,a,r,t,c,u,v,p,m;return(0,g.jsxs)("tr",{className:"stripRow ",style:{fontSize:"14px",fontFamily:"Manrope",fontWeight:"600"},children:[(0,g.jsx)("td",{className:"p-5 text-cmGrey800",children:null===l||void 0===l?void 0:l.group_name}),(0,g.jsx)("td",{className:"p-5 text-cmGrey600 ",children:(0,g.jsxs)("span",{className:"",children:[(null===l||void 0===l||null===(e=l.policies)||void 0===e||null===(o=e.administrator)||void 0===o?void 0:o.length)>0&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("span",{style:{color:"black"},children:"Administrator:"})," ",null===l||void 0===l||null===(a=l.policies)||void 0===a||null===(r=a.administrator)||void 0===r?void 0:r.map((l=>{var i;return null===l||void 0===l||null===(i=l.grouppolicydata)||void 0===i?void 0:i.policies})).join(", ")]}),(null===l||void 0===l||null===(t=l.policies)||void 0===t||null===(c=t.standard)||void 0===c?void 0:c.length)>0&&(0,g.jsxs)(g.Fragment,{children:[(null===l||void 0===l||null===(u=l.policies)||void 0===u||null===(v=u.administrator)||void 0===v?void 0:v.length)>0?(0,g.jsx)("br",{}):null,(0,g.jsx)("span",{style:{color:"black"},children:"Standard:"})," ",null===l||void 0===l||null===(p=l.policies)||void 0===p||null===(m=p.standard)||void 0===m?void 0:m.map((l=>{var i;return null===l||void 0===l||null===(i=l.grouppolicydata)||void 0===i?void 0:i.policies})).join(", ")]})]})}),(0,g.jsx)("td",{className:"p-4 text-cmGrey600 text-center",children:(0,g.jsx)("div",{className:"p-2 rounded bg-cmSuccess bg-opacity-10 text-cmSuccess cursor-pointer",onClick:()=>s("/permissions/usersOfGroup",{state:{id:null===l||void 0===l?void 0:l.group_id,name:null===l||void 0===l?void 0:l.group_name}}),children:null===l||void 0===l?void 0:l.members_count})}),(0,g.jsx)("td",{className:"p-5",children:(0,g.jsxs)("div",{className:"d-flex align-items-center gap-5",children:[(0,g.jsx)(b.ZP,{customCondition:k.l.administrator.permissions.group.edit,children:(0,g.jsx)(f.Z,{onClick:()=>n(null===l||void 0===l?void 0:l.group_id,null===l||void 0===l?void 0:l.group_name)})}),(null===l||void 0===l?void 0:l.members_count)<=0?(0,g.jsx)(b.ZP,{customCondition:k.l.administrator.permissions.group.delete,children:(0,g.jsx)(N.Z,{onClick:i=>{d(null===l||void 0===l?void 0:l.group_id)}})}):null]})})]},i)}))}):(0,g.jsx)("tr",{children:(0,g.jsx)("td",{colSpan:4,style:{textAlign:"center",fontFamily:"Manrope",fontWeight:"500",fontSize:14,paddingTop:20,paddingBottom:20},children:"No data found"})},"no-data")})]})})})})})};var G=e(91219),_=e(95095),C=e.n(_),S=e(42822);const Z=()=>{const l=(0,a.I0)(),[i,e]=(0,o.useState)(!1),t=(0,a.v9)(r.oQ),[c,m]=(0,o.useState)(t),[h,x]=(0,o.useState)("");(0,o.useEffect)((()=>{m(t)}),[t]);const[j,f]=(0,o.useState)([]),[N,_]=(0,o.useState)("Add"),[Z,P]=(0,o.useState)(!1),[z,B]=(0,o.useState)(!1);(0,o.useEffect)((()=>{i||(f(null),M())}),[i]);const M=(0,o.useCallback)((()=>{c?P(!0):B(!0),l((0,G.zU)()).finally((()=>{c?P(!1):B(!1)}))}),[l]);(0,o.useEffect)((()=>{l((0,G.Ex)())}),[]);const F=(0,o.useCallback)(C()((l=>{let i=(0,u.xT)(c,["group_name"],l);m(l?i&&i:c)}),500),[]);return(0,g.jsxs)("div",{style:{position:"relative"},children:[(0,g.jsx)(s.Z,{visible:z,full:!0}),(0,g.jsxs)("div",{className:"bg-white ",style:{fontSize:"14px",fontFamily:"Manrope",borderRadius:"0px 10px 10px 10px",boxShadow:"rgba(0, 0, 0, 0.05) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"},children:[!i&&(0,g.jsxs)("div",{className:"w-100 px-5 py-5 d-flex gap-5 mx-auto flex-wrap justify-content-between",children:[(0,g.jsx)("div",{style:{borderRadius:"20px"},className:"",id:"kt_chat_contacts_header",children:(0,g.jsx)("form",{className:"position-relative",style:{borderRadius:"90px"},autoComplete:"off",children:(0,g.jsx)(v.ZP,{type:v.rC.search,name:"search",onChange:l=>{F(l.target.value),x(l.target.value)},value:null!==h&&void 0!==h?h:""})})}),(0,g.jsxs)("div",{className:"mx-auto mx-sm-0 d-flex flex-direction-row",children:[(0,g.jsx)(s.Z,{visible:Z,size:50}),(0,g.jsx)(b.ZP,{customCondition:k.l.administrator.permissions.group.add,children:(0,g.jsx)(p.ZP,{type:"submit",buttonType:p.JB.primary,buttonLabel:" New Group",onClick:()=>{e(!i),_("Add")}})})]})]}),(0,g.jsxs)("div",{className:"mb-5",children:[!i&&(0,g.jsx)(w,{manageGroups:i,setManageGroups:e,permissionGroupList:c,deletePermission:l=>{S.Z.warn("Are you sure you want to delete ?",(()=>{B(!0),(0,d.Fvz)(l).then((()=>{M(),n.Z.success("Group Deleted")})).finally((()=>{B(!1)}))}))},updatePermission:(l,o)=>((l,o)=>{_("Update"),B(!0),e(!i),f({group_name:o,group_id:l}),(0,d.qZ)(l).then((l=>{f((i=>({...i,data:null===l||void 0===l?void 0:l.data})))})).finally((()=>{B(!1)}))})(l,o)}),i&&(0,g.jsx)(y,{manageGroups:i,setManageGroups:e,addUpdate:N,selectedGroup:j})]})]})]})}},91219:(l,i,e)=>{e.d(i,{Ex:()=>r,Ws:()=>a,zU:()=>s});var o=e(87311),d=e(39159),n=e(88965);const s=()=>l=>new Promise(((i,e)=>{(0,d.HjG)().then((e=>{(0,o.w1)(l,n.eA,null===e||void 0===e?void 0:e.data),i(null===e||void 0===e?void 0:e.data)})).catch(e)})),a=()=>l=>new Promise(((i,e)=>{(0,d.wQ2)().then((e=>{(0,o.w1)(l,n.z3,null===e||void 0===e?void 0:e.data),i(null===e||void 0===e?void 0:e.data)})).catch(e)})),r=()=>l=>new Promise(((i,e)=>{(0,d.PpS)().then((e=>{(0,o.w1)(l,n.A$,null===e||void 0===e?void 0:e.data),i(e)})).catch(e)}))},66608:(l,i,e)=>{e.d(i,{oQ:()=>o,w0:()=>n,z3:()=>d});const o=l=>{var i;return null===l||void 0===l||null===(i=l.permissions)||void 0===i?void 0:i.permissionGroupList},d=l=>{var i;return null===l||void 0===l||null===(i=l.permissions)||void 0===i?void 0:i.permissionPoliciesList},n=l=>{var i;return null===l||void 0===l||null===(i=l.permissions)||void 0===i?void 0:i.permissionGroupPolicyList}}}]);
//# sourceMappingURL=2652.6df0785e.chunk.js.map